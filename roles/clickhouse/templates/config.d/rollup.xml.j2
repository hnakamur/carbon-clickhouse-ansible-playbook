<clickhouse>
    <graphite_rollup>
        <path_column_name>Path</path_column_name>
        <time_column_name>Time</time_column_name>
        <value_column_name>Value</value_column_name>
        <version_column_name>Timestamp</version_column_name>
        <pattern>
            <regexp>^carbon\.</regexp>
            <retention>
                <age>0</age>
                <precision>60</precision>
            </retention>
        </pattern>
{% for func in ['max', 'min', 'sum'] %}
        <pattern>
            <rule_type>tag_list</rule_type>
            <regexp>agg={{ func }};pat=1s</regexp>
            <function>{{ func }}</function>
            <retention>
                <age>0</age>
                <precision>1</precision>
            </retention>
            <retention>
                <!-- 2d -->
                <age>172800</age>
                <precision>60</precision>
            </retention>
            <retention>
                <!-- 30d -->
                <age>2592000</age>
                <precision>3600</precision>
            </retention>
        </pattern>
{% endfor %}
{% for func in ['max', 'min', 'sum'] %}
        <pattern>
            <rule_type>tag_list</rule_type>
            <regexp>agg={{ func }};pat=1m</regexp>
            <function>{{ func }}</function>
            <retention>
                <age>0</age>
                <precision>60</precision>
            </retention>
            <retention>
                <!-- 30d -->
                <age>2592000</age>
                <precision>3600</precision>
            </retention>
        </pattern>
{% endfor %}
{% for func in ['max', 'min', 'sum'] %}
        <pattern>
            <rule_type>tag_list</rule_type>
            <regexp>agg={{ func }};pat=5m</regexp>
            <function>{{ func }}</function>
            <retention>
                <age>0</age>
                <precision>300</precision>
            </retention>
            <retention>
                <!-- 30d -->
                <age>2592000</age>
                <precision>3600</precision>
            </retention>
        </pattern>
{% endfor %}
{% for func in ['max', 'min', 'sum'] %}
        <pattern>
            <rule_type>tag_list</rule_type>
            <regexp>agg={{ func }};pat=1h</regexp>
            <function>{{ func }}</function>
            <retention>
                <age>0</age>
                <precision>3600</precision>
            </retention>
        </pattern>
{% endfor %}
{% for func in ['max', 'min', 'sum'] %}
        <pattern>
            <rule_type>tag_list</rule_type>
            <regexp>agg={{ func }};pat=1d</regexp>
            <function>{{ func }}</function>
            <retention>
                <age>0</age>
                <precision>3600</precision>
            </retention>
        </pattern>
{% endfor %}
        <pattern>
            <regexp>^my\.</regexp>
            <function>sum</function>
            <retention>
                <age>0</age>
                <precision>1</precision>
            </retention>
        </pattern>
        <default>
            <function>avg</function>
            <retention>
                <age>0</age>
                <precision>60</precision>
            </retention>
            <retention>
                <age>2592000</age>
                <precision>3600</precision>
            </retention>
        </default>
    </graphite_rollup>
</clickhouse>
